<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tags</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./tag-solid.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9fa745074439822173273f3e694597c8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-084754d1fd5c03d943eef65d7b62a8a5.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-9fa745074439822173273f3e694597c8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">BDNS-plus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./volumes-and-levels.html"> 
<span class="menu-text">Volumes &amp; Levels</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./tags.html" aria-current="page"> 
<span class="menu-text">Tags</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./customisations.html"> 
<span class="menu-text">Customisations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./serialisation.html"> 
<span class="menu-text">Serialisation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./revit.html"> 
<span class="menu-text">Revit</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./examples/index.html"> 
<span class="menu-text">Examples</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./compare-ifc4_3.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maxfordham/bdns-plus"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#default-tag-definitions" id="toc-default-tag-definitions" class="nav-link active" data-scroll-target="#default-tag-definitions">Default Tag Definitions</a></li>
  <li><a href="#custom-tag-definitions" id="toc-custom-tag-definitions" class="nav-link" data-scroll-target="#custom-tag-definitions">Custom Tag Definitions</a></li>
  <li><a href="#custom-tags-for-specific-equipment-types" id="toc-custom-tags-for-specific-equipment-types" class="nav-link" data-scroll-target="#custom-tags-for-specific-equipment-types">Custom Tags for Specific Equipment Types</a>
  <ul class="collapse">
  <li><a href="#how-to-define-the-scope-of-a-custom-tag" id="toc-how-to-define-the-scope-of-a-custom-tag" class="nav-link" data-scroll-target="#how-to-define-the-scope-of-a-custom-tag">How to Define the Scope of a Custom Tag</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tags</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>At its simplest, bdns-plus can be used to build tags from data. The <code>simple_tag</code> function takes a dictionary of data and a <code>TagDef</code> object, and returns a tag string. It is directly analogous to the way that tags work in Revit, and the <code>TagDef</code> class is a direct port of the Revit tag definition.</p>
<p>The example below shows how an instance tag can be built from a dictionary of data.</p>
<section id="default-tag-definitions" class="level2">
<h2 class="anchored" data-anchor-id="default-tag-definitions">Default Tag Definitions</h2>
<p>The default tag definitions are available in the <code>ConfigTags</code> class.</p>
<div id="15399dc6" class="cell" data-execution_count="2">
<section id="type-tag" class="level3 cell-output cell-output-display cell-output-markdown">
<h3 class="anchored" data-anchor-id="type-tag">Type Tag</h3>
<p>Default Tag Definition for indentifying a unique type of equipment, there is likely to be many instances of a type in the building. Expected to be used when a unique reference to every item is not required. For example, a light fitting type that may be used in many locations.</p>
<p><strong>Required</strong>: [abbreviation]</p>
<p><strong>Allowed</strong>: [abbreviation][type_reference]/[type_extra]</p>
</section>
<section id="instance-tag" class="level3 cell-output cell-output-display cell-output-markdown">
<h3 class="anchored" data-anchor-id="instance-tag">Instance Tag</h3>
<p>Default Tag Definition for indentifying a unique instance of equipment within a building. Expected to be used for adding equipment references to drawings, reports and legends.</p>
<p><strong>Required</strong>: [abbreviation]/[volume]/[level]/[level_iref]</p>
<p><strong>Allowed</strong>: [abbreviation]/[volume]/[level]/[level_iref]/[instance_extra]</p>
</section>
<section id="bdns-tag" class="level3 cell-output cell-output-display cell-output-markdown">
<h3 class="anchored" data-anchor-id="bdns-tag">BDNS Tag</h3>
<p>TagDef Definition in accordance with Building Data Naming System</p>
<p><strong>Required</strong>: [abbreviation]-[instance_reference]</p>
<p><strong>Allowed</strong>: [country]-[city]-[project]-[abbreviation]-[instance_reference]_[instance_extra]</p>
</section>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="2">
<p>The instance reference for the BDNS tag is constructed from volume and level data as follows:</p>
<ul>
<li>Volumes are represented by 1no integer digits (volume_id).</li>
<li>Levels are represented by 2no integer digits (level_id).</li>
<li>An enumerating integer value is added to ensure uniqueness for a given floor / level (volume_level_instance).</li>
<li>These numbers are joined without delimiter to create a unique number for a given abbreviation:
<ul>
<li>[volume_id][level_id][volume_level_instance]</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="custom-tag-definitions" class="level2">
<h2 class="anchored" data-anchor-id="custom-tag-definitions">Custom Tag Definitions</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Refer to <a href="examples/reformat-type-and-instance-tags">reformat-type-and-instance-tags</a> for a more comprehensive example.</p>
</div>
</div>
<div id="78067458" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tag_def <span class="op">=</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"name"</span>: <span class="st">"Equipment Instances"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"description"</span>: <span class="st">"a example tag definition with different formatting"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fields"</span>: [</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_name"</span>: <span class="st">"abbreviation"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_aliases"</span>: [</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Abbreviation"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"allow_none"</span>: <span class="va">False</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"prefix"</span>: <span class="st">""</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"suffix"</span>: <span class="st">""</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"zfill"</span>: <span class="va">None</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"regex"</span>: <span class="va">None</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"validator"</span>: <span class="va">None</span>,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_name"</span>: <span class="st">"volume"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_aliases"</span>: [</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Volume"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"allow_none"</span>: <span class="va">False</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">"prefix"</span>: <span class="st">"."</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">"suffix"</span>: <span class="st">""</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">"zfill"</span>: <span class="va">None</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">"regex"</span>: <span class="va">None</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">"validator"</span>: <span class="va">None</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_name"</span>: <span class="st">"level"</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_aliases"</span>: [</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Level"</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">"allow_none"</span>: <span class="va">False</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"prefix"</span>: <span class="st">"."</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"suffix"</span>: <span class="st">""</span>,</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"zfill"</span>: <span class="dv">2</span>,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"regex"</span>: <span class="va">None</span>,</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">"validator"</span>: <span class="va">None</span>,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_name"</span>: <span class="st">"level_iref"</span>,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">"field_aliases"</span>: [</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">"VolumeLevelInstance"</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">"allow_none"</span>: <span class="va">False</span>,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">"prefix"</span>: <span class="st">"."</span>,</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">"suffix"</span>: <span class="st">""</span>,</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">"zfill"</span>: <span class="dv">2</span>,</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">"regex"</span>: <span class="va">None</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">"validator"</span>: <span class="va">None</span>,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>itag_def <span class="op">=</span> TagDef(<span class="op">**</span>tag_def)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">"abbreviation"</span>: <span class="st">"AHU"</span>, <span class="st">"level"</span>: <span class="st">"GF"</span>, <span class="st">"level_iref"</span>: <span class="dv">1</span>, <span class="st">"volume"</span>: <span class="st">"N"</span>}</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>tag_string <span class="op">=</span> simple_tag(data, tag<span class="op">=</span>itag_def)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>json_str <span class="op">=</span> data_as_json_markdown(itag_def.model_dump(mode<span class="op">=</span><span class="st">"json"</span>))</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>title <span class="op">=</span> <span class="st">"Tag Definition as json data. Can be loaded dynamically and configured per project."</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>display(</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    Markdown(markdown_callout(json_str, title<span class="op">=</span>title)),</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>display(Markdown(summarise_tag_config(itag_def)))  <span class="co"># This will print the tag configuration summary</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>display(Markdown(<span class="st">"**Example:**"</span>))  <span class="co"># This will print the tag string</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>display(Markdown(data_as_yaml_markdown(data)))  <span class="co"># This will print the data as YAML markdown</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>display(Markdown(<span class="ss">f"**Tag String:** `</span><span class="sc">{</span>tag_string<span class="sc">}</span><span class="ss">`"</span>))  <span class="co"># This will print the tag string</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tag Definition as json data. Can be loaded dynamically and configured per project.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb2"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Equipment Instances"</span><span class="fu">,</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"description"</span><span class="fu">:</span> <span class="st">"a example tag definition with different formatting"</span><span class="fu">,</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"fields"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_name"</span><span class="fu">:</span> <span class="st">"abbreviation"</span><span class="fu">,</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_aliases"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Abbreviation"</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"allow_none"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"prefix"</span><span class="fu">:</span> <span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"suffix"</span><span class="fu">:</span> <span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"zfill"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"regex"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"validator"</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_name"</span><span class="fu">:</span> <span class="st">"volume"</span><span class="fu">,</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_aliases"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Volume"</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"allow_none"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"prefix"</span><span class="fu">:</span> <span class="st">"."</span><span class="fu">,</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"suffix"</span><span class="fu">:</span> <span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"zfill"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"regex"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"validator"</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_name"</span><span class="fu">:</span> <span class="st">"level"</span><span class="fu">,</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_aliases"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Level"</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"allow_none"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"prefix"</span><span class="fu">:</span> <span class="st">"."</span><span class="fu">,</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"suffix"</span><span class="fu">:</span> <span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"zfill"</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"regex"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"validator"</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_name"</span><span class="fu">:</span> <span class="st">"level_iref"</span><span class="fu">,</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"field_aliases"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>                <span class="st">"VolumeLevelInstance"</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>            <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"allow_none"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"prefix"</span><span class="fu">:</span> <span class="st">"."</span><span class="fu">,</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"suffix"</span><span class="fu">:</span> <span class="st">""</span><span class="fu">,</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"zfill"</span><span class="fu">:</span> <span class="dv">2</span><span class="fu">,</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"regex"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"validator"</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="equipment-instances" class="level3 cell-output cell-output-display cell-output-markdown">
<h3 class="anchored" data-anchor-id="equipment-instances">Equipment Instances</h3>
<p>a example tag definition with different formatting</p>
<p><strong>Required</strong>: [abbreviation].[volume].[level].[level_iref]</p>
<p><strong>Allowed</strong>: [abbreviation].[volume].[level].[level_iref]</p>
</section>
<div class="cell-output cell-output-display cell-output-markdown">
<p><strong>Example:</strong></p>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abbreviation</span><span class="kw">:</span><span class="at"> AHU</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">level</span><span class="kw">:</span><span class="at"> GF</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">level_iref</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">volume</span><span class="kw">:</span><span class="at"> </span><span class="ch">N</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><strong>Tag String:</strong> <code>AHU.N.GF.01</code></p>
</div>
</div>
</section>
<section id="custom-tags-for-specific-equipment-types" class="level2">
<h2 class="anchored" data-anchor-id="custom-tags-for-specific-equipment-types">Custom Tags for Specific Equipment Types</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Refer to <a href="examples/custom-nomenclature-for-vent-equipment">custom-nomenclature-for-vent-equipment</a> for a more comprehensive example.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled" title="not reccommended">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
not reccommended
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ideally tags should be consistent across all equipment types.</p>
</div>
</div>
<p>The <code>bdns-tag</code>, <code>type-tag</code> and <code>instance-tag</code> and generated for every item of equipment in the project, and are globally defined and unique for the project.</p>
<p>In an ideal world, the way that tags are constructed is consistent across all equipment types. However projects are messy, there are cases where specific equipment types require custom tags. In these cases it is possible to define custom tags with custom scopes.</p>
<section id="how-to-define-the-scope-of-a-custom-tag" class="level3">
<h3 class="anchored" data-anchor-id="how-to-define-the-scope-of-a-custom-tag">How to Define the Scope of a Custom Tag</h3>
<p>A RuleSet can be used to define the scope of a custom tag. (For more info refer to <a href="https://maxfordham.github.io/pyrulefilter/">pyrulefilter</a>. It allows the user to define a set of rules that are used to check the equipment data, and returns a boolean value indicating if a RuleSet matches the data. At Max Fordham, RuleSets are also used to define what equipment should be shown in a schedule, so by extension it is then possible to apply custom tags to every equipment item shown within a schedule.</p>
<section id="ruleset-definition" class="level4">
<h4 class="anchored" data-anchor-id="ruleset-definition">RuleSet Definition</h4>
<div id="94375495" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jsonschema2md</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyrulefilter <span class="im">import</span> RuleSet</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>parser <span class="op">=</span> jsonschema2md.Parser(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    examples_as_yaml<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    show_examples<span class="op">=</span><span class="st">"all"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>md_lines <span class="op">=</span> parser.parse_schema(RuleSet.model_json_schema())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>Markdown(<span class="st">""</span>.join(md_lines[<span class="dv">2</span>:]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="4">
<ul>
<li><a id="%24defs/FilterCategoriesEnum"></a><strong><code>FilterCategoriesEnum</code></strong> <em>(string)</em>: Must be one of: <code>["Analytical Spaces", "Analytical Surfaces", "Area Loads", "Areas", "Assemblies", "Audio Visual Devices", "Cable Trays", "Cable Tray Fittings", "Callouts", "Communication Devices", "Conduits", "Conduit Fittings", "Data Devices", "Detail Items", "Duct Accessories", "Ducts", "Duct Fittings", "Duct Insulations", "Duct Linings", "Duct Systems", "Air Terminals", "Electrical Equipment", "Electrical Fixtures", "MEP Fabrication Containment", "MEP Fabrication Ductwork", "Insulation", "Lining", "MEP Fabrication Hangers", "MEP Fabrication Pipework", "Insulation", "Fire Alarm Devices", "Fire Protection", "Flex Ducts", "Flex Pipes", "Analytical Floors", "Food Service Equipment", "Generic Models", "Multi-segmented Grid", "Grids", "Gutters", "HVAC Zones", "Lighting Devices", "Lighting Fixtures", "Analytical Links", "Air Systems", "Water Loops", "Spaces", "System-Zones", "Mechanical Equipment", "Medical Equipment", "Nurse Call Devices", "Pipe Accessories", "Pipes", "Pipe Fittings", "Pipe Insulations", "Piping Systems", "Duct Placeholders", "Pipe Placeholders", "Plumbing Fixtures", "Point Loads", "Reference Lines", "Rooms", "Sections", "Security Devices", "Sprinklers", "Switch System", "Telephone Devices", "Analytical Walls", "Zone Equipment"]</code>.</li>
<li><a id="%24defs/OperatorsEnum"></a><strong><code>OperatorsEnum</code></strong> <em>(string)</em>: Must be one of: <code>["begins with", "contains", "ends with", "equals", "does not begin with", "does not contain", "does not end with", "does not equal"]</code>.</li>
<li><a id="%24defs/Rule"></a><strong><code>Rule</code></strong> <em>(object)</em>
<ul>
<li><a id="%24defs/Rule/properties/categories"></a><strong><code>categories</code></strong> <em>(array)</em>: Revit MEP categories to filter by (i.e.&nbsp;revit object must belong to categories defined here). If empty, all categories are included. Default: <code>[]</code>.
<ul>
<li><a id="%24defs/Rule/properties/categories/items"></a><strong>Items</strong>: Refer to <em><a href="#%24defs/FilterCategoriesEnum">#/$defs/FilterCategoriesEnum</a></em>.</li>
</ul></li>
<li><a id="%24defs/Rule/properties/parameter"></a><strong><code>parameter</code></strong> <em>(string, required)</em>: name of schedule parameter against which to apply filter rule.</li>
<li><a id="%24defs/Rule/properties/operator"></a><strong><code>operator</code></strong>: logical operator used to evaluate parameter value against value below. Refer to <em><a href="#%24defs/OperatorsEnum">#/$defs/OperatorsEnum</a></em>.</li>
<li><a id="%24defs/Rule/properties/value"></a><strong><code>value</code></strong> <em>(string)</em>: Value to filter by. Evaluates to the appropriate type. Leave empty if none required (e.g.&nbsp;has value operator). Default: <code>""</code>.</li>
</ul></li>
<li><a id="%24defs/RuleSet"></a><strong><code>RuleSet</code></strong> <em>(object)</em>: A set of rules that defines what equipment specifications will appear in a given schedule.<br> Rules must evaluate to True for the item to be included in a schedule. This is analogous to how <font color="blue"><a href="https://help.autodesk.com/view/RVT/2023/ENU/?guid=GUID-400FD74B-00E0-4573-B3AC-3965E65CBBDB" target="blank">filter rules work in Revit.</a></font><br>As such, rules defined are imported into Revit and are used to create Revit Schedules.<br>
<hr>
.
<ul>
<li><a id="%24defs/RuleSet/properties/set_type"></a><strong><code>set_type</code></strong>: Refer to <em><a href="#%24defs/RuleSetType">#/$defs/RuleSetType</a></em>. Default: <code>"OR"</code>.</li>
<li><a id="%24defs/RuleSet/properties/rule"></a><strong><code>rule</code></strong> <em>(array, required)</em>: rules return a boolean for the logical evaluation defined below for every item within the categories defined .
<ul>
<li><a id="%24defs/RuleSet/properties/rule/items"></a><strong>Items</strong>
<ul>
<li><strong>Any of</strong>
<ul>
<li><a id="%24defs/RuleSet/properties/rule/items/anyOf/0"></a>: Refer to <em><a href="#%24defs/Rule">#/$defs/Rule</a></em>.</li>
<li><a id="%24defs/RuleSet/properties/rule/items/anyOf/1"></a>: Refer to <em><a href="#%24defs/RuleSet">#/$defs/RuleSet</a></em>.</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><a id="%24defs/RuleSetType"></a><strong><code>RuleSetType</code></strong> <em>(string)</em>: Must be one of: <code>["AND", "OR"]</code>.</li>
</ul>
</div>
</div>
</section>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<p>In this example, we show how a rule can be defined to give specific equipment a different tag if the data that defines that equipment matches a rule.</p>
<p>The Exammple below shows ventilation equipment tagged in the normal way, but well assume that AHUs must be named by their volume only (lets pretend that the project is a refurbishment and the AHU names already exist).</p>
<p>In the code below you can see how a ruleset is defined to filter out the equipment requiring a custom tag.</p>
<div id="df2d5f82" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyrulefilter <span class="im">import</span> Rule, RuleSet, ruleset_check_dicts</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bdns_plus.docs <span class="im">import</span> display_tag_data, get_idata_tag_table, get_tags, get_vent_equipment</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bdns_plus.gen_idata <span class="im">import</span> batch_gen_idata, gen_config_iref</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bdns_plus.models <span class="im">import</span> Config, CustomTagDef, GenDefinition, TagDef</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_idata_tag_df(header: <span class="bu">list</span>[<span class="bu">tuple</span>], idata: <span class="bu">list</span>[<span class="bu">dict</span>]) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    annotated_cols <span class="op">=</span> pd.MultiIndex.from_tuples(header)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    df_tags <span class="op">=</span> pd.DataFrame(idata).sort_values(by<span class="op">=</span>[<span class="st">"level"</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    df_tags.columns <span class="op">=</span> annotated_cols</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_tags</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>LEVEL_MIN, LEVEL_MAX, NO_VOLUMES <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>config_iref <span class="op">=</span> gen_config_iref(level_min<span class="op">=</span>LEVEL_MIN, level_max<span class="op">=</span>LEVEL_MAX, no_volumes<span class="op">=</span>NO_VOLUMES)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>idata <span class="op">=</span> get_vent_equipment(config_iref)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> Rule(</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    parameter<span class="op">=</span><span class="st">"abbreviation"</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    operator<span class="op">=</span><span class="st">"equals"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    value<span class="op">=</span><span class="st">"AHU"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>rule_set <span class="op">=</span> RuleSet(rule<span class="op">=</span>[r], set_type<span class="op">=</span><span class="st">"OR"</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>custom_tag_def <span class="op">=</span> TagDef(</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"Custom AHU Instance Tag"</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    fields<span class="op">=</span>[</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>        TagField(field_name<span class="op">=</span><span class="st">"abbreviation"</span>, suffix<span class="op">=</span><span class="st">"-"</span>),</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>        TagField(field_name<span class="op">=</span><span class="st">"volume"</span>, prefix<span class="op">=</span><span class="st">"Volume"</span>),</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>custom_tag <span class="op">=</span> CustomTagDef(</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    description<span class="op">=</span><span class="st">"Custom AHU Tag"</span>,</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    i_tag<span class="op">=</span>custom_tag_def,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    t_tag<span class="op">=</span>custom_tag_def,  <span class="co"># just override it to be the same</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    scope<span class="op">=</span>rule_set,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> Config(custom_tags<span class="op">=</span>[custom_tag])</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"section"</span>: <span class="st">"vent"</span>, <span class="st">"is_custom"</span>: <span class="st">"False"</span>} <span class="op">|</span> x.model_dump(mode<span class="op">=</span><span class="st">"json"</span>) <span class="op">|</span> get_tags(x, config<span class="op">=</span>config) <span class="cf">for</span> x <span class="kw">in</span> idata</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>]  <span class="co"># </span><span class="al">TODO</span><span class="co">: generalise this into fn in docs.py</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>di_arrays <span class="op">=</span> {key: [d.get(key, <span class="va">None</span>) <span class="cf">for</span> d <span class="kw">in</span> data] <span class="cf">for</span> key <span class="kw">in</span> data[<span class="dv">0</span>]}</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>di_arrays <span class="op">=</span> {k: [<span class="bu">str</span>(x) <span class="cf">if</span> x <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">else</span> <span class="st">""</span> <span class="cf">for</span> x <span class="kw">in</span> v] <span class="cf">for</span> k, v <span class="kw">in</span> di_arrays.items()}</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>df_tags <span class="op">=</span> pl.DataFrame(di_arrays)</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>df_tags <span class="op">=</span> df_tags.drop(<span class="st">"uniclass_ss"</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>display_tag_data(df_tags)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<div id="lahddiibjp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>
#lahddiibjp table {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

#lahddiibjp thead, tbody, tfoot, tr, td, th { border-style: none; }
 tr { background-color: transparent; }
#lahddiibjp p { margin: 0; padding: 0; }
 #lahddiibjp .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; }
 #lahddiibjp .gt_caption { padding-top: 4px; padding-bottom: 4px; }
 #lahddiibjp .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; }
 #lahddiibjp .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; }
 #lahddiibjp .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #lahddiibjp .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #lahddiibjp .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; }
 #lahddiibjp .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; }
 #lahddiibjp .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; }
 #lahddiibjp .gt_column_spanner_outer:first-child { padding-left: 0; }
 #lahddiibjp .gt_column_spanner_outer:last-child { padding-right: 0; }
 #lahddiibjp .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; }
 #lahddiibjp .gt_spanner_row { border-bottom-style: hidden; }
 #lahddiibjp .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; }
 #lahddiibjp .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; }
 #lahddiibjp .gt_from_md> :first-child { margin-top: 0; }
 #lahddiibjp .gt_from_md> :last-child { margin-bottom: 0; }
 #lahddiibjp .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; }
 #lahddiibjp .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; }
 #lahddiibjp .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; }
 #lahddiibjp .gt_row_group_first td { border-top-width: 2px; }
 #lahddiibjp .gt_row_group_first th { border-top-width: 2px; }
 #lahddiibjp .gt_striped { background-color: rgba(128,128,128,0.05); }
 #lahddiibjp .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }
 #lahddiibjp .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; }
 #lahddiibjp .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; text-align: left; }
 #lahddiibjp .gt_left { text-align: left; }
 #lahddiibjp .gt_center { text-align: center; }
 #lahddiibjp .gt_right { text-align: right; font-variant-numeric: tabular-nums; }
 #lahddiibjp .gt_font_normal { font-weight: normal; }
 #lahddiibjp .gt_font_bold { font-weight: bold; }
 #lahddiibjp .gt_font_italic { font-style: italic; }
 #lahddiibjp .gt_super { font-size: 65%; }
 #lahddiibjp .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; }
 #lahddiibjp .gt_asterisk { font-size: 100%; vertical-align: 0; }
 
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="11" class="gt_heading gt_title gt_font_normal">Equipment Tags</th>
</tr>
<tr class="gt_heading even">
<th colspan="11" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Projects contain multiple identical (equipment) type_tag's. bdns_tag's and instance_tag's are unique.</th>
</tr>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="section" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">section</th>
<th colspan="3" id="generated-outputs" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">generated outputs</span></th>
<th colspan="3" id="type-inputs" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">type inputs</span></th>
<th colspan="4" id="instance-inputs" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">instance inputs</span></th>
</tr>
<tr class="gt_col_headings even">
<th id="type_tag" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">type_tag</th>
<th id="instance_tag" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">instance_tag</th>
<th id="bdns_tag" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bdns_tag</th>
<th id="abbreviation" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: left; writing-mode: sideways-lr; vertical-align: middle; padding: 8px 0px;" scope="col">abbreviation</th>
<th id="type_reference" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: left; writing-mode: sideways-lr; vertical-align: middle; padding: 8px 0px;" scope="col">type_reference</th>
<th id="type_extra" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: left; writing-mode: sideways-lr; vertical-align: middle; padding: 8px 0px;" scope="col">type_extra</th>
<th id="volume" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: left; writing-mode: sideways-lr; vertical-align: middle; padding: 8px 0px;" scope="col">volume</th>
<th id="level" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: left; writing-mode: sideways-lr; vertical-align: middle; padding: 8px 0px;" scope="col">level</th>
<th id="level_iref" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: left; writing-mode: sideways-lr; vertical-align: middle; padding: 8px 0px;" scope="col">level_iref</th>
<th id="instance_extra" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="text-align: left; writing-mode: sideways-lr; vertical-align: middle; padding: 8px 0px;" scope="col">instance_extra</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left" style="background-color: yellow">AHU-Volume1</td>
<td class="gt_row gt_left" style="background-color: yellow">AHU-Volume1</td>
<td class="gt_row gt_left">AHU-1031</td>
<td class="gt_row gt_left">AHU</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">3</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left" style="background-color: yellow">AHU-Volume2</td>
<td class="gt_row gt_left" style="background-color: yellow">AHU-Volume2</td>
<td class="gt_row gt_left">AHU-2031</td>
<td class="gt_row gt_left">AHU</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">3</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/1/-1/1</td>
<td class="gt_row gt_left">MVHR-1991</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">-1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/1/-1/1</td>
<td class="gt_row gt_left">TEF-1991</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">-1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/1/0/1</td>
<td class="gt_row gt_left">MVHR-1001</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/1/0/1</td>
<td class="gt_row gt_left">TEF-1001</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/1/1/1</td>
<td class="gt_row gt_left">MVHR-1011</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/1/1/1</td>
<td class="gt_row gt_left">TEF-1011</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/1/2/1</td>
<td class="gt_row gt_left">MVHR-1021</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/1/2/1</td>
<td class="gt_row gt_left">TEF-1021</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/1/3/1</td>
<td class="gt_row gt_left">MVHR-1031</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">3</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/1/3/1</td>
<td class="gt_row gt_left">TEF-1031</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">3</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/2/-1/1</td>
<td class="gt_row gt_left">MVHR-2991</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">-1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/2/-1/1</td>
<td class="gt_row gt_left">TEF-2991</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">-1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/2/0/1</td>
<td class="gt_row gt_left">MVHR-2001</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/2/0/1</td>
<td class="gt_row gt_left">TEF-2001</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/2/1/1</td>
<td class="gt_row gt_left">MVHR-2011</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/2/1/1</td>
<td class="gt_row gt_left">TEF-2011</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/2/2/1</td>
<td class="gt_row gt_left">MVHR-2021</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/2/2/1</td>
<td class="gt_row gt_left">TEF-2021</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left">MVHR/2/3/1</td>
<td class="gt_row gt_left">MVHR-2031</td>
<td class="gt_row gt_left">MVHR</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">3</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left">TEF/2/3/1</td>
<td class="gt_row gt_left">TEF-2031</td>
<td class="gt_row gt_left">TEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left">3</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">KEF</td>
<td class="gt_row gt_left">KEF/1/0/1</td>
<td class="gt_row gt_left">KEF-1001</td>
<td class="gt_row gt_left">KEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">FAN</td>
<td class="gt_row gt_left">FAN/1/0/1</td>
<td class="gt_row gt_left">FAN-1001</td>
<td class="gt_row gt_left">FAN</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">KEF</td>
<td class="gt_row gt_left">KEF/1/0/2</td>
<td class="gt_row gt_left">KEF-1002</td>
<td class="gt_row gt_left">KEF</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" style="color: #000000; background-color: #f7fcf0">vent</td>
<td class="gt_row gt_left">FAN</td>
<td class="gt_row gt_left">FAN/1/0/2</td>
<td class="gt_row gt_left">FAN-1002</td>
<td class="gt_row gt_left">FAN</td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">1</td>
<td class="gt_row gt_left">0</td>
<td class="gt_row gt_left">2</td>
<td class="gt_row gt_left"></td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="11" class="gt_sourcenote">Yellow highlighting rows indicate rows that have custom tags.</td>
</tr>
</tfoot>

</table>


</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>